

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>python_pachyderm.mixin.pps &mdash; python-pachyderm  documentation</title>
  

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> python-pachyderm
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Docs</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../python_pachyderm.html">python_pachyderm</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">python-pachyderm</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
      <li>python_pachyderm.mixin.pps</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for python_pachyderm.mixin.pps</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">base64</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="kn">from</span> <span class="nn">python_pachyderm.proto.pps</span> <span class="kn">import</span> <span class="n">pps_pb2</span> <span class="k">as</span> <span class="n">pps_proto</span>
<span class="kn">from</span> <span class="nn">python_pachyderm.service</span> <span class="kn">import</span> <span class="n">Service</span>
<span class="kn">from</span> <span class="nn">.util</span> <span class="kn">import</span> <span class="n">commit_from</span>


<div class="viewcode-block" id="PPSMixin"><a class="viewcode-back" href="../../../python_pachyderm.mixin.html#python_pachyderm.mixin.pps.PPSMixin">[docs]</a><span class="k">class</span> <span class="nc">PPSMixin</span><span class="p">:</span>
<div class="viewcode-block" id="PPSMixin.inspect_job"><a class="viewcode-back" href="../../../python_pachyderm.mixin.html#python_pachyderm.mixin.pps.PPSMixin.inspect_job">[docs]</a>    <span class="k">def</span> <span class="nf">inspect_job</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">job_id</span><span class="p">,</span> <span class="n">block_state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output_commit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Inspects a job with a given ID. Returns a ``JobInfo``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        job_id : str</span>
<span class="sd">            The ID of the job to inspect.</span>
<span class="sd">        block_state : bool, optional</span>
<span class="sd">            If true, block until the job completes.</span>
<span class="sd">        output_commit : Union[tuple, str, Commit protobuf], optional</span>
<span class="sd">            Represents an output commit to filter on.</span>
<span class="sd">        full : bool, optional</span>
<span class="sd">            If true, include worker status.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_req</span><span class="p">(</span>
            <span class="n">Service</span><span class="o">.</span><span class="n">PPS</span><span class="p">,</span>
            <span class="s2">&quot;InspectJob&quot;</span><span class="p">,</span>
            <span class="n">job</span><span class="o">=</span><span class="n">pps_proto</span><span class="o">.</span><span class="n">Job</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">job_id</span><span class="p">),</span>
            <span class="n">block_state</span><span class="o">=</span><span class="n">block_state</span><span class="p">,</span>
            <span class="n">output_commit</span><span class="o">=</span><span class="n">commit_from</span><span class="p">(</span><span class="n">output_commit</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">output_commit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">full</span><span class="o">=</span><span class="n">full</span><span class="p">,</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="PPSMixin.list_job"><a class="viewcode-back" href="../../../python_pachyderm.mixin.html#python_pachyderm.mixin.pps.PPSMixin.list_job">[docs]</a>    <span class="k">def</span> <span class="nf">list_job</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">pipeline_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">input_commit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">output_commit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">history</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">full</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">jqFilter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;.. # noqa: W505</span>

<span class="sd">        Lists jobs. Yields ``JobInfo`` objects.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        pipeline_name : str, optional</span>
<span class="sd">            A pipeline name to filter on.</span>
<span class="sd">        input_commit : List[Union[tuple, str, Commit protobuf]], optional</span>
<span class="sd">            An optional list representing input commits to filter on.</span>
<span class="sd">        output_commit : Union[tuple, str, Commit protobuf], optional</span>
<span class="sd">            Represents an output commit to filter on.</span>
<span class="sd">        history : int, optional</span>
<span class="sd">            Indicates to return jobs from historical versions of pipelines.</span>
<span class="sd">            Semantics are:</span>

<span class="sd">            - 0: Return jobs from the current version of the pipeline or pipelines.</span>
<span class="sd">            - 1: Return the above and jobs from the next most recent version</span>
<span class="sd">            - 2: etc.</span>
<span class="sd">            - -1: Return jobs from all historical versions.</span>

<span class="sd">        full : bool, optional</span>
<span class="sd">            Whether the result should include all pipeline details in each</span>
<span class="sd">            ``JobInfo``, or limited information including name and status, but</span>
<span class="sd">            excluding information in the pipeline spec. Leaving this ``None``</span>
<span class="sd">            (or ``False``) can make the call significantly faster in clusters</span>
<span class="sd">            with a large number of pipelines and jobs. Note that if</span>
<span class="sd">            `input_commit` is set, this field is coerced to ``True``.</span>
<span class="sd">        jqFilter : str, optional</span>
<span class="sd">            A ``jq`` filter that can restrict the list of jobs returned.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">input_commit</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">input_commit</span> <span class="o">=</span> <span class="p">[</span><span class="n">commit_from</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span> <span class="k">for</span> <span class="n">ic</span> <span class="ow">in</span> <span class="n">input_commit</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">input_commit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">input_commit</span> <span class="o">=</span> <span class="p">[</span><span class="n">commit_from</span><span class="p">(</span><span class="n">input_commit</span><span class="p">)]</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_req</span><span class="p">(</span>
            <span class="n">Service</span><span class="o">.</span><span class="n">PPS</span><span class="p">,</span>
            <span class="s2">&quot;ListJobStream&quot;</span><span class="p">,</span>
            <span class="n">pipeline</span><span class="o">=</span><span class="n">pps_proto</span><span class="o">.</span><span class="n">Pipeline</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">pipeline_name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">pipeline_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">input_commit</span><span class="o">=</span><span class="n">input_commit</span><span class="p">,</span>
            <span class="n">output_commit</span><span class="o">=</span><span class="n">commit_from</span><span class="p">(</span><span class="n">output_commit</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">output_commit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">history</span><span class="o">=</span><span class="n">history</span><span class="p">,</span>
            <span class="n">full</span><span class="o">=</span><span class="n">full</span><span class="p">,</span>
            <span class="n">jqFilter</span><span class="o">=</span><span class="n">jqFilter</span><span class="p">,</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="PPSMixin.flush_job"><a class="viewcode-back" href="../../../python_pachyderm.mixin.html#python_pachyderm.mixin.pps.PPSMixin.flush_job">[docs]</a>    <span class="k">def</span> <span class="nf">flush_job</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">commits</span><span class="p">,</span> <span class="n">pipeline_names</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Blocks until all of the jobs which have a set of commits as</span>
<span class="sd">        provenance have finished. Yields ``JobInfo`` objects.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        commits : List[Union[tuple, str, Commit protobuf]]</span>
<span class="sd">            A list representing the commits to flush.</span>
<span class="sd">        pipeline_names : List[str], optional</span>
<span class="sd">            A list of strings specifying pipeline names. If specified, only</span>
<span class="sd">            jobs within these pipelines will be flushed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">pipeline_names</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">to_pipelines</span> <span class="o">=</span> <span class="p">[</span><span class="n">pps_proto</span><span class="o">.</span><span class="n">Pipeline</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">pipeline_names</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">to_pipelines</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_req</span><span class="p">(</span>
            <span class="n">Service</span><span class="o">.</span><span class="n">PPS</span><span class="p">,</span>
            <span class="s2">&quot;FlushJob&quot;</span><span class="p">,</span>
            <span class="n">commits</span><span class="o">=</span><span class="p">[</span><span class="n">commit_from</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">commits</span><span class="p">],</span>
            <span class="n">to_pipelines</span><span class="o">=</span><span class="n">to_pipelines</span><span class="p">,</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="PPSMixin.delete_job"><a class="viewcode-back" href="../../../python_pachyderm.mixin.html#python_pachyderm.mixin.pps.PPSMixin.delete_job">[docs]</a>    <span class="k">def</span> <span class="nf">delete_job</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">job_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Deletes a job by its ID.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        job_id : str</span>
<span class="sd">            The ID of the job to delete.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_req</span><span class="p">(</span><span class="n">Service</span><span class="o">.</span><span class="n">PPS</span><span class="p">,</span> <span class="s2">&quot;DeleteJob&quot;</span><span class="p">,</span> <span class="n">job</span><span class="o">=</span><span class="n">pps_proto</span><span class="o">.</span><span class="n">Job</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">job_id</span><span class="p">))</span></div>

<div class="viewcode-block" id="PPSMixin.stop_job"><a class="viewcode-back" href="../../../python_pachyderm.mixin.html#python_pachyderm.mixin.pps.PPSMixin.stop_job">[docs]</a>    <span class="k">def</span> <span class="nf">stop_job</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">job_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Stops a job by its ID.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        job_id : str</span>
<span class="sd">            The ID of the job to stop.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_req</span><span class="p">(</span><span class="n">Service</span><span class="o">.</span><span class="n">PPS</span><span class="p">,</span> <span class="s2">&quot;StopJob&quot;</span><span class="p">,</span> <span class="n">job</span><span class="o">=</span><span class="n">pps_proto</span><span class="o">.</span><span class="n">Job</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">job_id</span><span class="p">))</span></div>

<div class="viewcode-block" id="PPSMixin.inspect_datum"><a class="viewcode-back" href="../../../python_pachyderm.mixin.html#python_pachyderm.mixin.pps.PPSMixin.inspect_datum">[docs]</a>    <span class="k">def</span> <span class="nf">inspect_datum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">job_id</span><span class="p">,</span> <span class="n">datum_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Inspects a datum. Returns a ``DatumInfo`` object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        job_id : str</span>
<span class="sd">            The ID of the job.</span>
<span class="sd">        datum_id : str</span>
<span class="sd">            The ID of the datum.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_req</span><span class="p">(</span>
            <span class="n">Service</span><span class="o">.</span><span class="n">PPS</span><span class="p">,</span>
            <span class="s2">&quot;InspectDatum&quot;</span><span class="p">,</span>
            <span class="n">datum</span><span class="o">=</span><span class="n">pps_proto</span><span class="o">.</span><span class="n">Datum</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">datum_id</span><span class="p">,</span> <span class="n">job</span><span class="o">=</span><span class="n">pps_proto</span><span class="o">.</span><span class="n">Job</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">job_id</span><span class="p">)),</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="PPSMixin.list_datum"><a class="viewcode-back" href="../../../python_pachyderm.mixin.html#python_pachyderm.mixin.pps.PPSMixin.list_datum">[docs]</a>    <span class="k">def</span> <span class="nf">list_datum</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">job_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">page_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">page</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">input</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">status_only</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Lists datums. Yields ``ListDatumStreamResponse`` objects.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        job_id : str, optional</span>
<span class="sd">            The ID of a job. Exactly one of `job_id` (real) or `input`</span>
<span class="sd">            (hypothetical) must be set.</span>
<span class="sd">        page_size : int, optional</span>
<span class="sd">            The size of the page.</span>
<span class="sd">        page : int, optional</span>
<span class="sd">            The page number.</span>
<span class="sd">        input : Input protobuf, optional</span>
<span class="sd">            If set in lieu of `job_id`, ``list_datum()`` returns the datums</span>
<span class="sd">            that would be given to a hypothetical job that used `input` as its</span>
<span class="sd">            input spec. Exactly one of `job_id` (real) or `input`</span>
<span class="sd">            (hypothetical) must be set.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_req</span><span class="p">(</span>
            <span class="n">Service</span><span class="o">.</span><span class="n">PPS</span><span class="p">,</span>
            <span class="s2">&quot;ListDatumStream&quot;</span><span class="p">,</span>
            <span class="n">job</span><span class="o">=</span><span class="n">pps_proto</span><span class="o">.</span><span class="n">Job</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">job_id</span><span class="p">),</span>
            <span class="n">page_size</span><span class="o">=</span><span class="n">page_size</span><span class="p">,</span>
            <span class="n">page</span><span class="o">=</span><span class="n">page</span><span class="p">,</span>
            <span class="nb">input</span><span class="o">=</span><span class="nb">input</span><span class="p">,</span>
            <span class="n">status_only</span><span class="o">=</span><span class="n">status_only</span><span class="p">,</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="PPSMixin.restart_datum"><a class="viewcode-back" href="../../../python_pachyderm.mixin.html#python_pachyderm.mixin.pps.PPSMixin.restart_datum">[docs]</a>    <span class="k">def</span> <span class="nf">restart_datum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">job_id</span><span class="p">,</span> <span class="n">data_filters</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Restarts a datum.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        job_id : str</span>
<span class="sd">            The ID of the job.</span>
<span class="sd">        data_filters : List[str], optional</span>
<span class="sd">            An optional iterable of strings.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_req</span><span class="p">(</span>
            <span class="n">Service</span><span class="o">.</span><span class="n">PPS</span><span class="p">,</span>
            <span class="s2">&quot;RestartDatum&quot;</span><span class="p">,</span>
            <span class="n">job</span><span class="o">=</span><span class="n">pps_proto</span><span class="o">.</span><span class="n">Job</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">job_id</span><span class="p">),</span>
            <span class="n">data_filters</span><span class="o">=</span><span class="n">data_filters</span><span class="p">,</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="PPSMixin.create_pipeline"><a class="viewcode-back" href="../../../python_pachyderm.mixin.html#python_pachyderm.mixin.pps.PPSMixin.create_pipeline">[docs]</a>    <span class="k">def</span> <span class="nf">create_pipeline</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">pipeline_name</span><span class="p">,</span>
        <span class="n">transform</span><span class="p">,</span>
        <span class="n">parallelism_spec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">hashtree_spec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">egress</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">update</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">output_branch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">resource_requests</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">resource_limits</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="nb">input</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">cache_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">enable_stats</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">reprocess</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">max_queue_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">service</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">chunk_spec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">datum_timeout</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">job_timeout</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">salt</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">standby</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">datum_tries</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">scheduling_spec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">pod_patch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">spout</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">spec_commit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">metadata</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">s3_out</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">sidecar_resource_limits</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">reprocess_spec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">autoscaling</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a pipeline. For more info, please refer to the pipeline spec</span>
<span class="sd">        document:</span>
<span class="sd">        http://docs.pachyderm.io/en/latest/reference/pipeline_spec.html</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        pipeline_name : str</span>
<span class="sd">            The pipeline name.</span>
<span class="sd">        transform : Transform protobuf</span>
<span class="sd">            A ``Transform`` object.</span>
<span class="sd">        parallelism_spec : ParallelismSpec protobuf, optional</span>
<span class="sd">            An optional ``ParallelismSpec`` object.</span>
<span class="sd">        hashtree_spec : HashtreeSpec protobuf, optional</span>
<span class="sd">            An optional ``HashtreeSpec`` object.</span>
<span class="sd">        egress : Egress protobuf, optional</span>
<span class="sd">            An optional ``Egress`` object.</span>
<span class="sd">        update : bool, optional</span>
<span class="sd">            Whether this should behave as an upsert.</span>
<span class="sd">        output_branch : str, optional</span>
<span class="sd">            The branch to output results on.</span>
<span class="sd">        resource_requests : ResourceSpec protobuf, optional</span>
<span class="sd">            An optional ``ResourceSpec`` object.</span>
<span class="sd">        resource_limits : ResourceSpec protobuf, optional</span>
<span class="sd">            An optional ``ResourceSpec`` object.</span>
<span class="sd">        input : Input protobuf, optional</span>
<span class="sd">            An optional ``Input`` object.</span>
<span class="sd">        description : str, optional</span>
<span class="sd">            Description of the pipeline.</span>
<span class="sd">        cache_size : str, optional</span>
<span class="sd">            An optional string.</span>
<span class="sd">        enable_stats : bool, optional</span>
<span class="sd">            An optional bool.</span>
<span class="sd">        reprocess : bool, optional</span>
<span class="sd">            If true, Pachyderm forces the pipeline to reprocess all datums. It</span>
<span class="sd">            only has meaning if `update` is ``True``.</span>
<span class="sd">        max_queue_size : int, optional</span>
<span class="sd">            An optional int.</span>
<span class="sd">        service : Service protobuf, optional</span>
<span class="sd">            An optional ``Service`` object.</span>
<span class="sd">        chunk_spec : ChunkSpec protobuf, optional</span>
<span class="sd">            An optional ``ChunkSpec`` object.</span>
<span class="sd">        datum_timeout : Duration protobuf, optional</span>
<span class="sd">            An optional ``Duration`` object.</span>
<span class="sd">        job_timeout : Duration protobuf, optional</span>
<span class="sd">            An optional ``Duration`` object.</span>
<span class="sd">        salt : str, optional</span>
<span class="sd">            An optional string.</span>
<span class="sd">        standby : bool, optional</span>
<span class="sd">            An optional bool.</span>
<span class="sd">        datum_tries : int, optional</span>
<span class="sd">            An optional int.</span>
<span class="sd">        scheduling_spec : SchedulingSpec protobuf, optional</span>
<span class="sd">            An optional ``SchedulingSpec`` object.</span>
<span class="sd">        pod_patch : str, optional</span>
<span class="sd">            An optional string.</span>
<span class="sd">        spout : Spout protobuf, optional</span>
<span class="sd">            An optional ``Spout`` object.</span>
<span class="sd">        spec_commit : Commit protobuf, optional</span>
<span class="sd">            An optional ``Commit`` object.</span>
<span class="sd">        metadata : Metadata protobuf, optional</span>
<span class="sd">            An optional ``Metadata`` object.</span>
<span class="sd">        s3_out : bool, optional</span>
<span class="sd">            Unused.</span>
<span class="sd">        sidecar_resource_limits : ResourceSpec protobuf, optional</span>
<span class="sd">            An optional ``ResourceSpec`` setting resource limits for the</span>
<span class="sd">            pipeline sidecar.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Support for build step-enabled pipelines. This is a python port of</span>
        <span class="c1"># the equivalent functionality in pachyderm core&#39;s</span>
        <span class="c1"># &#39;src/server/pps/cmds/cmds.go&#39;, and any changes made here likely have</span>
        <span class="c1"># to be reflected there as well.</span>
        <span class="k">if</span> <span class="n">transform</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">image</span> <span class="ow">or</span> <span class="n">transform</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">language</span> <span class="ow">or</span> <span class="n">transform</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">path</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">spout</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;build step-enabled pipelines do not work with spouts&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">input</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;no `input` specified&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">transform</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">language</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">transform</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">image</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;must specify either a build `language` or `image`&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">transform</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">language</span> <span class="ow">and</span> <span class="n">transform</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">image</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;cannot specify both a build `language` and `image`&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span>
                <span class="n">i</span><span class="o">.</span><span class="n">pfs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">i</span><span class="o">.</span><span class="n">pfs</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;build&quot;</span><span class="p">,</span> <span class="s2">&quot;source&quot;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">pipeline_inputs</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
            <span class="p">):</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                    <span class="s2">&quot;build step-enabled pipelines cannot have inputs with the name &quot;</span>
                    <span class="o">+</span> <span class="s2">&quot;&#39;build&#39; or &#39;source&#39;, as they are reserved for build assets&quot;</span>
                <span class="p">)</span>

            <span class="n">build_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">transform</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">path</span> <span class="ow">or</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">build_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;build path </span><span class="si">{}</span><span class="s2"> does not exist&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">build_path</span><span class="p">))</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">build_path</span> <span class="o">/</span> <span class="s2">&quot;.pachignore&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                    <span class="s2">&quot;detected a &#39;.pachignore&#39; file, but it&#39;s unsupported by python_pachyderm -- use `pachctl` instead&quot;</span><span class="p">,</span>
                    <span class="ne">RuntimeWarning</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="n">build_pipeline_name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">_build&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pipeline_name</span><span class="p">)</span>

            <span class="n">image</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">image</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">image</span><span class="p">:</span>
                <span class="n">version</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_remote_version</span><span class="p">()</span>
                <span class="n">version_str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">.</span><span class="si">{}</span><span class="s2">.</span><span class="si">{}{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">version</span><span class="o">.</span><span class="n">major</span><span class="p">,</span> <span class="n">version</span><span class="o">.</span><span class="n">minor</span><span class="p">,</span> <span class="n">version</span><span class="o">.</span><span class="n">micro</span><span class="p">,</span> <span class="n">version</span><span class="o">.</span><span class="n">additional</span>
                <span class="p">)</span>
                <span class="n">image</span> <span class="o">=</span> <span class="s2">&quot;pachyderm/</span><span class="si">{}</span><span class="s2">-build:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">transform</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">language</span><span class="p">,</span> <span class="n">version_str</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">transform</span><span class="o">.</span><span class="n">image</span><span class="p">:</span>
                <span class="n">transform</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">image</span>

            <span class="k">def</span> <span class="nf">create_build_pipeline_input</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">pps_proto</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span>
                    <span class="n">pfs</span><span class="o">=</span><span class="n">pps_proto</span><span class="o">.</span><span class="n">PFSInput</span><span class="p">(</span>
                        <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                        <span class="n">glob</span><span class="o">=</span><span class="s2">&quot;/&quot;</span><span class="p">,</span>
                        <span class="n">repo</span><span class="o">=</span><span class="n">build_pipeline_name</span><span class="p">,</span>
                        <span class="n">branch</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">create_repo</span><span class="p">(</span><span class="n">build_pipeline_name</span><span class="p">,</span> <span class="n">update</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_req</span><span class="p">(</span>
                <span class="n">Service</span><span class="o">.</span><span class="n">PPS</span><span class="p">,</span>
                <span class="s2">&quot;CreatePipeline&quot;</span><span class="p">,</span>
                <span class="n">pipeline</span><span class="o">=</span><span class="n">pps_proto</span><span class="o">.</span><span class="n">Pipeline</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">build_pipeline_name</span><span class="p">),</span>
                <span class="n">transform</span><span class="o">=</span><span class="n">pps_proto</span><span class="o">.</span><span class="n">Transform</span><span class="p">(</span><span class="n">image</span><span class="o">=</span><span class="n">image</span><span class="p">,</span> <span class="n">cmd</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;sh&quot;</span><span class="p">,</span> <span class="s2">&quot;./build.sh&quot;</span><span class="p">]),</span>
                <span class="n">parallelism_spec</span><span class="o">=</span><span class="n">pps_proto</span><span class="o">.</span><span class="n">ParallelismSpec</span><span class="p">(</span><span class="n">constant</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="nb">input</span><span class="o">=</span><span class="n">create_build_pipeline_input</span><span class="p">(</span><span class="s2">&quot;source&quot;</span><span class="p">),</span>
                <span class="n">output_branch</span><span class="o">=</span><span class="s2">&quot;build&quot;</span><span class="p">,</span>
                <span class="n">update</span><span class="o">=</span><span class="n">update</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">put_file_client</span><span class="p">()</span> <span class="k">as</span> <span class="n">pfc</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">update</span><span class="p">:</span>
                    <span class="n">pfc</span><span class="o">.</span><span class="n">delete_file</span><span class="p">((</span><span class="n">build_pipeline_name</span><span class="p">,</span> <span class="s2">&quot;source&quot;</span><span class="p">),</span> <span class="s2">&quot;/&quot;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">filenames</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">build_path</span><span class="p">)):</span>
                    <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">filenames</span><span class="p">:</span>
                        <span class="n">source_filepath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
                        <span class="n">dest_filepath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                            <span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">relpath</span><span class="p">(</span><span class="n">source_filepath</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">build_path</span><span class="p">))</span>
                        <span class="p">)</span>
                        <span class="n">pfc</span><span class="o">.</span><span class="n">put_file_from_filepath</span><span class="p">(</span>
                            <span class="p">(</span><span class="n">build_pipeline_name</span><span class="p">,</span> <span class="s2">&quot;source&quot;</span><span class="p">),</span>
                            <span class="n">dest_filepath</span><span class="p">,</span>
                            <span class="n">source_filepath</span><span class="p">,</span>
                        <span class="p">)</span>

            <span class="nb">input</span> <span class="o">=</span> <span class="n">pps_proto</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span>
                <span class="n">cross</span><span class="o">=</span><span class="p">[</span>
                    <span class="n">create_build_pipeline_input</span><span class="p">(</span><span class="s2">&quot;source&quot;</span><span class="p">),</span>
                    <span class="n">create_build_pipeline_input</span><span class="p">(</span><span class="s2">&quot;build&quot;</span><span class="p">),</span>
                    <span class="nb">input</span><span class="p">,</span>
                <span class="p">]</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">transform</span><span class="o">.</span><span class="n">cmd</span><span class="p">:</span>
                <span class="n">transform</span><span class="o">.</span><span class="n">cmd</span><span class="p">[:]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;sh&quot;</span><span class="p">,</span> <span class="s2">&quot;/pfs/build/run.sh&quot;</span><span class="p">]</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_req</span><span class="p">(</span>
            <span class="n">Service</span><span class="o">.</span><span class="n">PPS</span><span class="p">,</span>
            <span class="s2">&quot;CreatePipeline&quot;</span><span class="p">,</span>
            <span class="n">pipeline</span><span class="o">=</span><span class="n">pps_proto</span><span class="o">.</span><span class="n">Pipeline</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">pipeline_name</span><span class="p">),</span>
            <span class="n">transform</span><span class="o">=</span><span class="n">transform</span><span class="p">,</span>
            <span class="n">parallelism_spec</span><span class="o">=</span><span class="n">parallelism_spec</span><span class="p">,</span>
            <span class="n">hashtree_spec</span><span class="o">=</span><span class="n">hashtree_spec</span><span class="p">,</span>
            <span class="n">egress</span><span class="o">=</span><span class="n">egress</span><span class="p">,</span>
            <span class="n">update</span><span class="o">=</span><span class="n">update</span><span class="p">,</span>
            <span class="n">output_branch</span><span class="o">=</span><span class="n">output_branch</span><span class="p">,</span>
            <span class="n">resource_requests</span><span class="o">=</span><span class="n">resource_requests</span><span class="p">,</span>
            <span class="n">resource_limits</span><span class="o">=</span><span class="n">resource_limits</span><span class="p">,</span>
            <span class="nb">input</span><span class="o">=</span><span class="nb">input</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
            <span class="n">cache_size</span><span class="o">=</span><span class="n">cache_size</span><span class="p">,</span>
            <span class="n">enable_stats</span><span class="o">=</span><span class="n">enable_stats</span><span class="p">,</span>
            <span class="n">reprocess</span><span class="o">=</span><span class="n">reprocess</span><span class="p">,</span>
            <span class="n">max_queue_size</span><span class="o">=</span><span class="n">max_queue_size</span><span class="p">,</span>
            <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span>
            <span class="n">service</span><span class="o">=</span><span class="n">service</span><span class="p">,</span>
            <span class="n">chunk_spec</span><span class="o">=</span><span class="n">chunk_spec</span><span class="p">,</span>
            <span class="n">datum_timeout</span><span class="o">=</span><span class="n">datum_timeout</span><span class="p">,</span>
            <span class="n">job_timeout</span><span class="o">=</span><span class="n">job_timeout</span><span class="p">,</span>
            <span class="n">salt</span><span class="o">=</span><span class="n">salt</span><span class="p">,</span>
            <span class="n">standby</span><span class="o">=</span><span class="n">standby</span><span class="p">,</span>
            <span class="n">datum_tries</span><span class="o">=</span><span class="n">datum_tries</span><span class="p">,</span>
            <span class="n">scheduling_spec</span><span class="o">=</span><span class="n">scheduling_spec</span><span class="p">,</span>
            <span class="n">pod_patch</span><span class="o">=</span><span class="n">pod_patch</span><span class="p">,</span>
            <span class="n">spout</span><span class="o">=</span><span class="n">spout</span><span class="p">,</span>
            <span class="n">spec_commit</span><span class="o">=</span><span class="n">spec_commit</span><span class="p">,</span>
            <span class="n">sidecar_resource_limits</span><span class="o">=</span><span class="n">sidecar_resource_limits</span><span class="p">,</span>
            <span class="n">reprocess_spec</span><span class="o">=</span><span class="n">reprocess_spec</span><span class="p">,</span>
            <span class="n">autoscaling</span><span class="o">=</span><span class="n">autoscaling</span><span class="p">,</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="PPSMixin.create_pipeline_from_request"><a class="viewcode-back" href="../../../python_pachyderm.mixin.html#python_pachyderm.mixin.pps.PPSMixin.create_pipeline_from_request">[docs]</a>    <span class="k">def</span> <span class="nf">create_pipeline_from_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">req</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates a pipeline from a ``CreatePipelineRequest`` object. Usually</span>
<span class="sd">        this would be used in conjunction with</span>
<span class="sd">        ``util.parse_json_pipeline_spec()`` or</span>
<span class="sd">        ``util.parse_dict_pipeline_spec()``. If you&#39;re in pure python and not</span>
<span class="sd">        working with a pipeline spec file, the sibling method</span>
<span class="sd">        ``create_pipeline()`` is more ergonomic.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        req : CreatePipelineRequest protobuf</span>
<span class="sd">            A `CreatePipelineRequest` object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_req</span><span class="p">(</span><span class="n">Service</span><span class="o">.</span><span class="n">PPS</span><span class="p">,</span> <span class="s2">&quot;CreatePipeline&quot;</span><span class="p">,</span> <span class="n">req</span><span class="o">=</span><span class="n">req</span><span class="p">)</span></div>

<div class="viewcode-block" id="PPSMixin.create_tf_job_pipeline"><a class="viewcode-back" href="../../../python_pachyderm.mixin.html#python_pachyderm.mixin.pps.PPSMixin.create_tf_job_pipeline">[docs]</a>    <span class="k">def</span> <span class="nf">create_tf_job_pipeline</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">pipeline_name</span><span class="p">,</span>
        <span class="n">tf_job</span><span class="p">,</span>
        <span class="n">parallelism_spec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">hashtree_spec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">egress</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">update</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">output_branch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">scale_down_threshold</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">resource_requests</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">resource_limits</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="nb">input</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">cache_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">enable_stats</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">reprocess</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">max_queue_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">service</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">chunk_spec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">datum_timeout</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">job_timeout</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">salt</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">standby</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">datum_tries</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">scheduling_spec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">pod_patch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">spout</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">spec_commit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates a pipeline. For more info, please refer to the pipeline spec</span>
<span class="sd">        document:</span>
<span class="sd">        http://docs.pachyderm.io/en/latest/reference/pipeline_spec.html</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        pipeline_name : str</span>
<span class="sd">            The pipeline name.</span>
<span class="sd">        tf_job : TFJob protobuf</span>
<span class="sd">            Pachyderm uses this to create TFJobs when running in a Kubernetes</span>
<span class="sd">            cluster on which kubeflow has been installed.</span>
<span class="sd">        parallelism_spec : ParallelismSpec protobuf, optional</span>
<span class="sd">            An optional ``ParallelismSpec`` object.</span>
<span class="sd">        hashtree_spec : HashtreeSpec protobuf, optional</span>
<span class="sd">            An optional ``HashtreeSpec`` object.</span>
<span class="sd">        egress : Egress protobuf, optional</span>
<span class="sd">            An optional ``Egress`` object.</span>
<span class="sd">        update : bool, optional</span>
<span class="sd">            Whether this should behave as an upsert.</span>
<span class="sd">        output_branch : str, optional</span>
<span class="sd">            The branch to output results on.</span>
<span class="sd">        scale_down_threshold : Duration protobuf, optional</span>
<span class="sd">            An optional `Duration` object.</span>
<span class="sd">        resource_requests : ResourceSpec protobuf, optional</span>
<span class="sd">            An optional ``ResourceSpec`` object.</span>
<span class="sd">        resource_limits : ResourceSpec protobuf, optional</span>
<span class="sd">            An optional ``ResourceSpec`` object.</span>
<span class="sd">        input : Input protobuf, optional</span>
<span class="sd">            An optional ``Input`` object.</span>
<span class="sd">        description : str, optional</span>
<span class="sd">            Description of the pipeline.</span>
<span class="sd">        cache_size : str, optional</span>
<span class="sd">            An optional string.</span>
<span class="sd">        enable_stats : bool, optional</span>
<span class="sd">            An optional bool.</span>
<span class="sd">        reprocess : bool, optional</span>
<span class="sd">            If true, Pachyderm forces the pipeline to reprocess all datums. It</span>
<span class="sd">            only has meaning if `update` is ``True``.</span>
<span class="sd">        max_queue_size : int, optional</span>
<span class="sd">            An optional int.</span>
<span class="sd">        service : Service protobuf, optional</span>
<span class="sd">            An optional ``Service`` object.</span>
<span class="sd">        chunk_spec : ChunkSpec protobuf, optional</span>
<span class="sd">            An optional ``ChunkSpec`` object.</span>
<span class="sd">        datum_timeout : Duration protobuf, optional</span>
<span class="sd">            An optional ``Duration`` object.</span>
<span class="sd">        job_timeout : Duration protobuf, optional</span>
<span class="sd">            An optional ``Duration`` object.</span>
<span class="sd">        salt : str, optional</span>
<span class="sd">            An optional string.</span>
<span class="sd">        standby : bool, optional</span>
<span class="sd">            An optional bool.</span>
<span class="sd">        datum_tries : int, optional</span>
<span class="sd">            An optional int.</span>
<span class="sd">        scheduling_spec : SchedulingSpec protobuf, optional</span>
<span class="sd">            An optional ``SchedulingSpec`` object.</span>
<span class="sd">        pod_patch : str, optional</span>
<span class="sd">            An optional string.</span>
<span class="sd">        spout : Spout protobuf, optional</span>
<span class="sd">            An optional ``Spout`` object.</span>
<span class="sd">        spec_commit : Commit protobuf, optional</span>
<span class="sd">            An optional ``Commit`` object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_req</span><span class="p">(</span>
            <span class="n">Service</span><span class="o">.</span><span class="n">PPS</span><span class="p">,</span>
            <span class="s2">&quot;CreatePipeline&quot;</span><span class="p">,</span>
            <span class="n">pipeline</span><span class="o">=</span><span class="n">pps_proto</span><span class="o">.</span><span class="n">Pipeline</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">pipeline_name</span><span class="p">),</span>
            <span class="n">tf_job</span><span class="o">=</span><span class="n">tf_job</span><span class="p">,</span>
            <span class="n">parallelism_spec</span><span class="o">=</span><span class="n">parallelism_spec</span><span class="p">,</span>
            <span class="n">hashtree_spec</span><span class="o">=</span><span class="n">hashtree_spec</span><span class="p">,</span>
            <span class="n">egress</span><span class="o">=</span><span class="n">egress</span><span class="p">,</span>
            <span class="n">update</span><span class="o">=</span><span class="n">update</span><span class="p">,</span>
            <span class="n">output_branch</span><span class="o">=</span><span class="n">output_branch</span><span class="p">,</span>
            <span class="n">scale_down_threshold</span><span class="o">=</span><span class="n">scale_down_threshold</span><span class="p">,</span>
            <span class="n">resource_requests</span><span class="o">=</span><span class="n">resource_requests</span><span class="p">,</span>
            <span class="n">resource_limits</span><span class="o">=</span><span class="n">resource_limits</span><span class="p">,</span>
            <span class="nb">input</span><span class="o">=</span><span class="nb">input</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
            <span class="n">cache_size</span><span class="o">=</span><span class="n">cache_size</span><span class="p">,</span>
            <span class="n">enable_stats</span><span class="o">=</span><span class="n">enable_stats</span><span class="p">,</span>
            <span class="n">reprocess</span><span class="o">=</span><span class="n">reprocess</span><span class="p">,</span>
            <span class="n">max_queue_size</span><span class="o">=</span><span class="n">max_queue_size</span><span class="p">,</span>
            <span class="n">service</span><span class="o">=</span><span class="n">service</span><span class="p">,</span>
            <span class="n">chunk_spec</span><span class="o">=</span><span class="n">chunk_spec</span><span class="p">,</span>
            <span class="n">datum_timeout</span><span class="o">=</span><span class="n">datum_timeout</span><span class="p">,</span>
            <span class="n">job_timeout</span><span class="o">=</span><span class="n">job_timeout</span><span class="p">,</span>
            <span class="n">salt</span><span class="o">=</span><span class="n">salt</span><span class="p">,</span>
            <span class="n">standby</span><span class="o">=</span><span class="n">standby</span><span class="p">,</span>
            <span class="n">datum_tries</span><span class="o">=</span><span class="n">datum_tries</span><span class="p">,</span>
            <span class="n">scheduling_spec</span><span class="o">=</span><span class="n">scheduling_spec</span><span class="p">,</span>
            <span class="n">pod_patch</span><span class="o">=</span><span class="n">pod_patch</span><span class="p">,</span>
            <span class="n">spout</span><span class="o">=</span><span class="n">spout</span><span class="p">,</span>
            <span class="n">spec_commit</span><span class="o">=</span><span class="n">spec_commit</span><span class="p">,</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="PPSMixin.inspect_pipeline"><a class="viewcode-back" href="../../../python_pachyderm.mixin.html#python_pachyderm.mixin.pps.PPSMixin.inspect_pipeline">[docs]</a>    <span class="k">def</span> <span class="nf">inspect_pipeline</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pipeline_name</span><span class="p">,</span> <span class="n">history</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;.. # noqa: W505</span>

<span class="sd">        Inspects a pipeline. Returns a ``PipelineInfo`` object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        pipeline_name : str</span>
<span class="sd">            The pipeline name.</span>
<span class="sd">        history : int, optional</span>
<span class="sd">            Indicates to return historical versions of pipelines. Semantics</span>
<span class="sd">            are:</span>

<span class="sd">            - 0: Return current version of pipelines.</span>
<span class="sd">            - 1: Return the above and pipelines from the next most recent version.</span>
<span class="sd">            - 2: etc.</span>
<span class="sd">            - -1: Return pipelines from all historical versions.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pipeline</span> <span class="o">=</span> <span class="n">pps_proto</span><span class="o">.</span><span class="n">Pipeline</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">pipeline_name</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">history</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_req</span><span class="p">(</span><span class="n">Service</span><span class="o">.</span><span class="n">PPS</span><span class="p">,</span> <span class="s2">&quot;InspectPipeline&quot;</span><span class="p">,</span> <span class="n">pipeline</span><span class="o">=</span><span class="n">pipeline</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># `InspectPipeline` doesn&#39;t support history, but `ListPipeline`</span>
            <span class="c1"># with a pipeline filter does, so we use that here</span>
            <span class="n">pipelines</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_req</span><span class="p">(</span>
                <span class="n">Service</span><span class="o">.</span><span class="n">PPS</span><span class="p">,</span> <span class="s2">&quot;ListPipeline&quot;</span><span class="p">,</span> <span class="n">pipeline</span><span class="o">=</span><span class="n">pipeline</span><span class="p">,</span> <span class="n">history</span><span class="o">=</span><span class="n">history</span>
            <span class="p">)</span><span class="o">.</span><span class="n">pipeline_info</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">pipelines</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span>
            <span class="k">return</span> <span class="n">pipelines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pipelines</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="PPSMixin.list_pipeline"><a class="viewcode-back" href="../../../python_pachyderm.mixin.html#python_pachyderm.mixin.pps.PPSMixin.list_pipeline">[docs]</a>    <span class="k">def</span> <span class="nf">list_pipeline</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">history</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">allow_incomplete</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">jqFilter</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;.. # noqa: W505</span>

<span class="sd">        Lists pipelines. Returns a `PipelineInfos` object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        history : int, optional</span>
<span class="sd">            Indicates to return historical versions of pipelines. Semantics</span>
<span class="sd">            are:</span>

<span class="sd">            - 0: Return current version of pipelines.</span>
<span class="sd">            - 1: Return the above and pipelines from the next most recent version.</span>
<span class="sd">            - 2: etc.</span>
<span class="sd">            - -1: Return pipelines from all historical versions.</span>

<span class="sd">        allow_incomplete : bool, optional</span>
<span class="sd">            If True, causes ``list_pipeline()`` to return ``PipelineInfos``</span>
<span class="sd">            with incomplete data where the pipeline spec cannot be retrieved.</span>
<span class="sd">            Incomplete ``PipelineInfos`` will have a ``None`` `Transform`</span>
<span class="sd">            field, but will have the fields present in ``EtcdPipelineInfo``.</span>
<span class="sd">        jqFilter : str, optional</span>
<span class="sd">            A ``jq`` filter that can restrict the list of pipelines returned.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_req</span><span class="p">(</span>
            <span class="n">Service</span><span class="o">.</span><span class="n">PPS</span><span class="p">,</span>
            <span class="s2">&quot;ListPipeline&quot;</span><span class="p">,</span>
            <span class="n">history</span><span class="o">=</span><span class="n">history</span><span class="p">,</span>
            <span class="n">allow_incomplete</span><span class="o">=</span><span class="n">allow_incomplete</span><span class="p">,</span>
            <span class="n">jqFilter</span><span class="o">=</span><span class="n">jqFilter</span><span class="p">,</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="PPSMixin.delete_pipeline"><a class="viewcode-back" href="../../../python_pachyderm.mixin.html#python_pachyderm.mixin.pps.PPSMixin.delete_pipeline">[docs]</a>    <span class="k">def</span> <span class="nf">delete_pipeline</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">pipeline_name</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keep_repo</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">split_transaction</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Deletes a pipeline.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        pipeline_name : str</span>
<span class="sd">            The pipeline name.</span>
<span class="sd">        force : bool, optional</span>
<span class="sd">            Whether to force delete.</span>
<span class="sd">        keep_repo : bool, optional</span>
<span class="sd">            Whether to keep the output repo.</span>
<span class="sd">        split_transaction : bool, optional</span>
<span class="sd">            Whether Pachyderm attempts to delete the pipeline in a single</span>
<span class="sd">            database transaction. Setting this to ``True`` can work around</span>
<span class="sd">            certain Pachyderm errors, but, if set, the ``delete_repo()` call</span>
<span class="sd">            may need to be retried.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_req</span><span class="p">(</span>
            <span class="n">Service</span><span class="o">.</span><span class="n">PPS</span><span class="p">,</span>
            <span class="s2">&quot;DeletePipeline&quot;</span><span class="p">,</span>
            <span class="n">pipeline</span><span class="o">=</span><span class="n">pps_proto</span><span class="o">.</span><span class="n">Pipeline</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">pipeline_name</span><span class="p">),</span>
            <span class="n">force</span><span class="o">=</span><span class="n">force</span><span class="p">,</span>
            <span class="n">keep_repo</span><span class="o">=</span><span class="n">keep_repo</span><span class="p">,</span>
            <span class="n">split_transaction</span><span class="o">=</span><span class="n">split_transaction</span><span class="p">,</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="PPSMixin.delete_all_pipelines"><a class="viewcode-back" href="../../../python_pachyderm.mixin.html#python_pachyderm.mixin.pps.PPSMixin.delete_all_pipelines">[docs]</a>    <span class="k">def</span> <span class="nf">delete_all_pipelines</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Deletes all pipelines.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        force : bool, optional</span>
<span class="sd">            Whether to force delete.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_req</span><span class="p">(</span><span class="n">Service</span><span class="o">.</span><span class="n">PPS</span><span class="p">,</span> <span class="s2">&quot;DeletePipeline&quot;</span><span class="p">,</span> <span class="nb">all</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="n">force</span><span class="p">)</span></div>

<div class="viewcode-block" id="PPSMixin.start_pipeline"><a class="viewcode-back" href="../../../python_pachyderm.mixin.html#python_pachyderm.mixin.pps.PPSMixin.start_pipeline">[docs]</a>    <span class="k">def</span> <span class="nf">start_pipeline</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pipeline_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Starts a pipeline.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        pipeline_name : str</span>
<span class="sd">            The pipeline name.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_req</span><span class="p">(</span>
            <span class="n">Service</span><span class="o">.</span><span class="n">PPS</span><span class="p">,</span>
            <span class="s2">&quot;StartPipeline&quot;</span><span class="p">,</span>
            <span class="n">pipeline</span><span class="o">=</span><span class="n">pps_proto</span><span class="o">.</span><span class="n">Pipeline</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">pipeline_name</span><span class="p">),</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="PPSMixin.stop_pipeline"><a class="viewcode-back" href="../../../python_pachyderm.mixin.html#python_pachyderm.mixin.pps.PPSMixin.stop_pipeline">[docs]</a>    <span class="k">def</span> <span class="nf">stop_pipeline</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pipeline_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Stops a pipeline.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        pipeline_name : str</span>
<span class="sd">            The pipeline name.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_req</span><span class="p">(</span>
            <span class="n">Service</span><span class="o">.</span><span class="n">PPS</span><span class="p">,</span> <span class="s2">&quot;StopPipeline&quot;</span><span class="p">,</span> <span class="n">pipeline</span><span class="o">=</span><span class="n">pps_proto</span><span class="o">.</span><span class="n">Pipeline</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">pipeline_name</span><span class="p">)</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="PPSMixin.run_pipeline"><a class="viewcode-back" href="../../../python_pachyderm.mixin.html#python_pachyderm.mixin.pps.PPSMixin.run_pipeline">[docs]</a>    <span class="k">def</span> <span class="nf">run_pipeline</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pipeline_name</span><span class="p">,</span> <span class="n">provenance</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">job_id</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Runs a pipeline.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        pipeline_name : str</span>
<span class="sd">            The pipeline name.</span>
<span class="sd">        provenance : List[CommitProvenance protobuf], optional</span>
<span class="sd">            A list representing the pipeline execution provenance.</span>
<span class="sd">        job_id : str, optional</span>
<span class="sd">            A specific job ID to run.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_req</span><span class="p">(</span>
            <span class="n">Service</span><span class="o">.</span><span class="n">PPS</span><span class="p">,</span>
            <span class="s2">&quot;RunPipeline&quot;</span><span class="p">,</span>
            <span class="n">pipeline</span><span class="o">=</span><span class="n">pps_proto</span><span class="o">.</span><span class="n">Pipeline</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">pipeline_name</span><span class="p">),</span>
            <span class="n">provenance</span><span class="o">=</span><span class="n">provenance</span><span class="p">,</span>
            <span class="n">job_id</span><span class="o">=</span><span class="n">job_id</span><span class="p">,</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="PPSMixin.run_cron"><a class="viewcode-back" href="../../../python_pachyderm.mixin.html#python_pachyderm.mixin.pps.PPSMixin.run_cron">[docs]</a>    <span class="k">def</span> <span class="nf">run_cron</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pipeline_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Explicitly triggers a pipeline with one or more cron inputs to run</span>
<span class="sd">        now.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        pipeline_name : str</span>
<span class="sd">            The pipeline name.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_req</span><span class="p">(</span>
            <span class="n">Service</span><span class="o">.</span><span class="n">PPS</span><span class="p">,</span>
            <span class="s2">&quot;RunCron&quot;</span><span class="p">,</span>
            <span class="n">pipeline</span><span class="o">=</span><span class="n">pps_proto</span><span class="o">.</span><span class="n">Pipeline</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">pipeline_name</span><span class="p">),</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="PPSMixin.create_secret"><a class="viewcode-back" href="../../../python_pachyderm.mixin.html#python_pachyderm.mixin.pps.PPSMixin.create_secret">[docs]</a>    <span class="k">def</span> <span class="nf">create_secret</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">secret_name</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">annotations</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates a new secret.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        secret_name : str</span>
<span class="sd">            The name of the secret to create.</span>
<span class="sd">        data : Dict[str, Union[str, bytes]]</span>
<span class="sd">            The data to store in the secret. Each key must consist of</span>
<span class="sd">            alphanumeric characters ``-``, ``_`` or ``.``.</span>
<span class="sd">        labels : Dict[str, str], optional</span>
<span class="sd">            Kubernetes labels to attach to the secret.</span>
<span class="sd">        annotations : Dict[str, str], optional</span>
<span class="sd">            Kubernetes annotations to attach to the secret.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">encoded_data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">v</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">)</span>
            <span class="n">encoded_data</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">)</span>

        <span class="n">f</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;kind&quot;</span><span class="p">:</span> <span class="s2">&quot;Secret&quot;</span><span class="p">,</span>
                <span class="s2">&quot;apiVersion&quot;</span><span class="p">:</span> <span class="s2">&quot;v1&quot;</span><span class="p">,</span>
                <span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">secret_name</span><span class="p">,</span>
                    <span class="s2">&quot;labels&quot;</span><span class="p">:</span> <span class="n">labels</span><span class="p">,</span>
                    <span class="s2">&quot;annotations&quot;</span><span class="p">:</span> <span class="n">annotations</span><span class="p">,</span>
                <span class="p">},</span>
                <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">encoded_data</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_req</span><span class="p">(</span><span class="n">Service</span><span class="o">.</span><span class="n">PPS</span><span class="p">,</span> <span class="s2">&quot;CreateSecret&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">f</span><span class="p">)</span></div>

<div class="viewcode-block" id="PPSMixin.delete_secret"><a class="viewcode-back" href="../../../python_pachyderm.mixin.html#python_pachyderm.mixin.pps.PPSMixin.delete_secret">[docs]</a>    <span class="k">def</span> <span class="nf">delete_secret</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">secret_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Deletes a secret.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        secret_name : str</span>
<span class="sd">            The name of the secret to delete.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">secret</span> <span class="o">=</span> <span class="n">pps_proto</span><span class="o">.</span><span class="n">Secret</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">secret_name</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_req</span><span class="p">(</span><span class="n">Service</span><span class="o">.</span><span class="n">PPS</span><span class="p">,</span> <span class="s2">&quot;DeleteSecret&quot;</span><span class="p">,</span> <span class="n">secret</span><span class="o">=</span><span class="n">secret</span><span class="p">)</span></div>

<div class="viewcode-block" id="PPSMixin.list_secret"><a class="viewcode-back" href="../../../python_pachyderm.mixin.html#python_pachyderm.mixin.pps.PPSMixin.list_secret">[docs]</a>    <span class="k">def</span> <span class="nf">list_secret</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Lists secrets. Returns a list of ``SecretInfo`` objects.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_req</span><span class="p">(</span>
            <span class="n">Service</span><span class="o">.</span><span class="n">PPS</span><span class="p">,</span>
            <span class="s2">&quot;ListSecret&quot;</span><span class="p">,</span>
            <span class="n">req</span><span class="o">=</span><span class="n">pps_proto</span><span class="o">.</span><span class="n">google_dot_protobuf_dot_empty__pb2</span><span class="o">.</span><span class="n">Empty</span><span class="p">(),</span>
        <span class="p">)</span><span class="o">.</span><span class="n">secret_info</span></div>

<div class="viewcode-block" id="PPSMixin.inspect_secret"><a class="viewcode-back" href="../../../python_pachyderm.mixin.html#python_pachyderm.mixin.pps.PPSMixin.inspect_secret">[docs]</a>    <span class="k">def</span> <span class="nf">inspect_secret</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">secret_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Inspects a secret.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        secret_name : str</span>
<span class="sd">            The name of the secret to inspect.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">secret</span> <span class="o">=</span> <span class="n">pps_proto</span><span class="o">.</span><span class="n">Secret</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">secret_name</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_req</span><span class="p">(</span><span class="n">Service</span><span class="o">.</span><span class="n">PPS</span><span class="p">,</span> <span class="s2">&quot;InspectSecret&quot;</span><span class="p">,</span> <span class="n">secret</span><span class="o">=</span><span class="n">secret</span><span class="p">)</span></div>

<div class="viewcode-block" id="PPSMixin.delete_all"><a class="viewcode-back" href="../../../python_pachyderm.mixin.html#python_pachyderm.mixin.pps.PPSMixin.delete_all">[docs]</a>    <span class="k">def</span> <span class="nf">delete_all</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Deletes everything in Pachyderm.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_req</span><span class="p">(</span>
            <span class="n">Service</span><span class="o">.</span><span class="n">PPS</span><span class="p">,</span>
            <span class="s2">&quot;DeleteAll&quot;</span><span class="p">,</span>
            <span class="n">req</span><span class="o">=</span><span class="n">pps_proto</span><span class="o">.</span><span class="n">google_dot_protobuf_dot_empty__pb2</span><span class="o">.</span><span class="n">Empty</span><span class="p">(),</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="PPSMixin.get_pipeline_logs"><a class="viewcode-back" href="../../../python_pachyderm.mixin.html#python_pachyderm.mixin.pps.PPSMixin.get_pipeline_logs">[docs]</a>    <span class="k">def</span> <span class="nf">get_pipeline_logs</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">pipeline_name</span><span class="p">,</span>
        <span class="n">data_filters</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">master</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">datum</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">follow</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">tail</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">use_loki_backend</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">since</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gets logs for a pipeline. Yields ``LogMessage`` objects.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        pipeline_name : str</span>
<span class="sd">            The name of the pipeline.</span>
<span class="sd">        data_filters : List[str], optional</span>
<span class="sd">            A list of the names of input files from which we want processing</span>
<span class="sd">            logs. This may contain multiple files, in case `pipeline_name`</span>
<span class="sd">            contains multiple inputs. Each filter may be an absolute path of a</span>
<span class="sd">            file within a repo, or it may be a hash for that file (to search</span>
<span class="sd">            for files at specific versions).</span>
<span class="sd">        master : bool, optional</span>
<span class="sd">            If true, includes logs from the master</span>
<span class="sd">        datum : Datum protobuf, optional</span>
<span class="sd">            Filters log lines for the specified datum.</span>
<span class="sd">        follow : bool, optional</span>
<span class="sd">            If true, continue to follow new logs as they appear.</span>
<span class="sd">        tail : int, optional</span>
<span class="sd">            If nonzero, the number of lines from the end of the logs to return.</span>
<span class="sd">            Note: tail applies per container, so you will get</span>
<span class="sd">            `tail` * &lt;number of pods&gt; total lines back.</span>
<span class="sd">        use_loki_backend : bool, optional</span>
<span class="sd">            If true, use loki as a backend, rather than Kubernetes, for</span>
<span class="sd">            fetching logs. Requires a loki-enabled cluster.</span>
<span class="sd">        since : Duration protobuf, optional</span>
<span class="sd">            Specifies how far in the past to return logs from.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_req</span><span class="p">(</span>
            <span class="n">Service</span><span class="o">.</span><span class="n">PPS</span><span class="p">,</span>
            <span class="s2">&quot;GetLogs&quot;</span><span class="p">,</span>
            <span class="n">pipeline</span><span class="o">=</span><span class="n">pps_proto</span><span class="o">.</span><span class="n">Pipeline</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">pipeline_name</span><span class="p">),</span>
            <span class="n">data_filters</span><span class="o">=</span><span class="n">data_filters</span><span class="p">,</span>
            <span class="n">master</span><span class="o">=</span><span class="n">master</span><span class="p">,</span>
            <span class="n">datum</span><span class="o">=</span><span class="n">datum</span><span class="p">,</span>
            <span class="n">follow</span><span class="o">=</span><span class="n">follow</span><span class="p">,</span>
            <span class="n">tail</span><span class="o">=</span><span class="n">tail</span><span class="p">,</span>
            <span class="n">use_loki_backend</span><span class="o">=</span><span class="n">use_loki_backend</span><span class="p">,</span>
            <span class="n">since</span><span class="o">=</span><span class="n">since</span><span class="p">,</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="PPSMixin.get_job_logs"><a class="viewcode-back" href="../../../python_pachyderm.mixin.html#python_pachyderm.mixin.pps.PPSMixin.get_job_logs">[docs]</a>    <span class="k">def</span> <span class="nf">get_job_logs</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">job_id</span><span class="p">,</span>
        <span class="n">data_filters</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">datum</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">follow</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">tail</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">use_loki_backend</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">since</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gets logs for a job. Yields `LogMessage` objects.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        job_id : str</span>
<span class="sd">            The ID of the job.</span>
<span class="sd">        data_filters : List[str], optional</span>
<span class="sd">            A list of the names of input files from which we want processing</span>
<span class="sd">            logs. This may contain multiple files, in case `pipeline_name`</span>
<span class="sd">            contains multiple inputs. Each filter may be an absolute path of a</span>
<span class="sd">            file within a repo, or it may be a hash for that file (to search</span>
<span class="sd">            for files at specific versions).</span>
<span class="sd">        datum : Datum protobuf, optional</span>
<span class="sd">            Filters log lines for the specified datum.</span>
<span class="sd">        follow : bool, optional</span>
<span class="sd">            If true, continue to follow new logs as they appear.</span>
<span class="sd">        tail : int, optional</span>
<span class="sd">            If nonzero, the number of lines from the end of the logs to return.</span>
<span class="sd">            Note: tail applies per container, so you will get</span>
<span class="sd">            `tail` * &lt;number of pods&gt; total lines back.</span>
<span class="sd">        use_loki_backend : bool, optional</span>
<span class="sd">            If true, use loki as a backend, rather than Kubernetes, for</span>
<span class="sd">            fetching logs. Requires a loki-enabled cluster.</span>
<span class="sd">        since : Duration protobuf, optional</span>
<span class="sd">            Specifies how far in the past to return logs from.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_req</span><span class="p">(</span>
            <span class="n">Service</span><span class="o">.</span><span class="n">PPS</span><span class="p">,</span>
            <span class="s2">&quot;GetLogs&quot;</span><span class="p">,</span>
            <span class="n">job</span><span class="o">=</span><span class="n">pps_proto</span><span class="o">.</span><span class="n">Job</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">job_id</span><span class="p">),</span>
            <span class="n">data_filters</span><span class="o">=</span><span class="n">data_filters</span><span class="p">,</span>
            <span class="n">datum</span><span class="o">=</span><span class="n">datum</span><span class="p">,</span>
            <span class="n">follow</span><span class="o">=</span><span class="n">follow</span><span class="p">,</span>
            <span class="n">tail</span><span class="o">=</span><span class="n">tail</span><span class="p">,</span>
            <span class="n">use_loki_backend</span><span class="o">=</span><span class="n">use_loki_backend</span><span class="p">,</span>
            <span class="n">since</span><span class="o">=</span><span class="n">since</span><span class="p">,</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="PPSMixin.garbage_collect"><a class="viewcode-back" href="../../../python_pachyderm.mixin.html#python_pachyderm.mixin.pps.PPSMixin.garbage_collect">[docs]</a>    <span class="k">def</span> <span class="nf">garbage_collect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memory_bytes</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Runs garbage collection.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        memory_bytes : int, optional</span>
<span class="sd">            How much memory to use in computing which objects are alive. A</span>
<span class="sd">            larger number will result in more precise garbage collection (at</span>
<span class="sd">            the cost of more memory usage).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_req</span><span class="p">(</span><span class="n">Service</span><span class="o">.</span><span class="n">PPS</span><span class="p">,</span> <span class="s2">&quot;GarbageCollect&quot;</span><span class="p">,</span> <span class="n">memory_bytes</span><span class="o">=</span><span class="n">memory_bytes</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="pipeline_inputs"><a class="viewcode-back" href="../../../python_pachyderm.mixin.html#python_pachyderm.mixin.pps.pipeline_inputs">[docs]</a><span class="k">def</span> <span class="nf">pipeline_inputs</span><span class="p">(</span><span class="n">root</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">root</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span>
    <span class="k">elif</span> <span class="n">root</span><span class="o">.</span><span class="n">cross</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">root</span><span class="o">.</span><span class="n">cross</span><span class="p">:</span>
            <span class="k">yield from</span> <span class="n">pipeline_inputs</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">root</span><span class="o">.</span><span class="n">join</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">root</span><span class="o">.</span><span class="n">join</span><span class="p">:</span>
            <span class="k">yield from</span> <span class="n">pipeline_inputs</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">root</span><span class="o">.</span><span class="n">union</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">root</span><span class="o">.</span><span class="n">union</span><span class="p">:</span>
            <span class="k">yield from</span> <span class="n">pipeline_inputs</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="k">yield</span> <span class="n">root</span></div>
</pre></div>

           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Joe Doliner.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>